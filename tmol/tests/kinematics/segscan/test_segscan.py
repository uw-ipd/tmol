import pytest

import torch

from tmol.utility.cpp_extension import load, relpaths, modulename

from tmol.tests.torch import requires_cuda


@requires_cuda
@pytest.fixture
def extension():
    return load(modulename(f"{__name__}.cuda"), relpaths(__file__, "segscan.cu"))


@requires_cuda
def test_segscan_inclusive(extension):
    """Test inclusive segscan with known correct answer"""
    x = torch.ones(10, dtype=torch.float32)
    segs = torch.tensor([0, 3, 5], dtype=torch.int32)
    xcuda = x.to(device="cuda")
    segscuda = segs.to(device="cuda")

    gold = torch.cat(
        [
            torch.arange(3, dtype=torch.float32) + 1,
            torch.arange(2, dtype=torch.float32) + 1,
            torch.arange(5, dtype=torch.float32) + 1,
        ]
    )
    y = extension.segscan_incl(xcuda, segscuda)
    y = y.to(device="cpu")

    torch.testing.assert_allclose(gold, y)


@requires_cuda
def test_segscan_exclusive(extension):
    """Test inclusive segscan with known correct answer"""
    x = torch.ones(10, dtype=torch.float32)
    segs = torch.tensor([0, 3, 5], dtype=torch.int32)
    xcuda = x.to(device="cuda")
    segscuda = segs.to(device="cuda")

    gold = torch.cat(
        [
            torch.arange(3, dtype=torch.float32),
            torch.arange(2, dtype=torch.float32),
            torch.arange(5, dtype=torch.float32),
        ]
    )
    y = extension.segscan_excl(xcuda, segscuda)
    y = y.to(device="cpu")

    torch.testing.assert_allclose(gold, y)


@requires_cuda
def test_segscan(extension):
    """CUDA segscan code"""

    # x = torch.ones(1000000, dtype=torch.float32)
    # segs = torch.tensor([4, 7, 35, 273, 1129, 43567, 143678, 567778], dtype=torch.int)
    x = torch.ones(1000, dtype=torch.float32)
    segs = torch.tensor([13], dtype=torch.int)
    xcuda = x.to(device="cuda")
    segscuda = segs.to(device="cuda")

    y = extension.segscan_incl(x, segs)
    ycuda = extension.segscan_incl(xcuda, segscuda)

    torch.testing.assert_allclose(ycuda.to(device="cpu"), y)

    y = extension.segscan_excl(x, segs)
    ycuda = extension.segscan_excl(xcuda, segscuda)

    torch.testing.assert_allclose(ycuda.to(device="cpu"), y)


@requires_cuda
def test_segscan2(extension):
    """CUDA segscan code"""

    # x = torch.ones(1000000, dtype=torch.float32)
    # segs = torch.tensor([4, 7, 35, 273, 1129, 43567, 143678, 567778], dtype=torch.int)
    x = torch.arange(1000, dtype=torch.float32)
    segs = torch.tensor([13], dtype=torch.int)
    xcuda = x.to(device="cuda")
    segscuda = segs.to(device="cuda")

    y = extension.weird_segscan_incl_128_2(x, segs)
    ycuda = extension.weird_segscan_incl_128_2(xcuda, segscuda)

    torch.testing.assert_allclose(ycuda.to(device="cpu"), y)

    y = extension.segscan_excl(x, segs)
    ycuda = extension.segscan_excl(xcuda, segscuda)

    torch.testing.assert_allclose(ycuda.to(device="cpu"), y)


@requires_cuda
def test_segscan_highly_segmented(extension):
    x = torch.ones(808, dtype=torch.float32)
    segs = torch.tensor(
        [
            0,
            2,
            4,
            6,
            8,
            10,
            12,
            14,
            16,
            18,
            20,
            22,
            24,
            27,
            29,
            31,
            33,
            35,
            37,
            39,
            41,
            45,
            47,
            49,
            52,
            54,
            56,
            58,
            60,
            62,
            64,
            66,
            68,
            70,
            72,
            74,
            76,
            78,
            81,
            83,
            85,
            87,
            89,
            91,
            94,
            96,
            98,
            100,
            103,
            105,
            107,
            109,
            111,
            113,
            115,
            117,
            119,
            121,
            123,
            125,
            127,
            129,
            132,
            134,
            136,
            138,
            141,
            143,
            145,
            147,
            149,
            151,
            154,
            156,
            158,
            160,
            162,
            164,
            166,
            169,
            171,
            173,
            175,
            177,
            179,
            181,
            183,
            186,
            188,
            190,
            192,
            194,
            196,
            198,
            200,
            202,
            204,
            206,
            208,
            210,
            212,
            214,
            216,
            218,
            220,
            222,
            225,
            227,
            229,
            231,
            234,
            236,
            238,
            240,
            242,
            244,
            246,
            248,
            250,
            252,
            254,
            256,
            258,
            260,
            262,
            265,
            267,
            269,
            271,
            273,
            275,
            277,
            279,
            281,
            283,
            285,
            287,
            289,
            291,
            293,
            295,
            297,
            299,
            301,
            303,
            305,
            307,
            309,
            311,
            313,
            315,
            317,
            320,
            322,
            324,
            326,
            328,
            330,
            332,
            334,
            336,
            338,
            340,
            342,
            344,
            346,
            348,
            350,
            352,
            354,
            356,
            358,
            360,
            362,
            364,
            366,
            368,
            370,
            372,
            374,
            376,
            379,
            381,
            383,
            385,
            387,
            389,
            391,
            393,
            395,
            397,
            399,
            401,
            403,
            405,
            407,
            409,
            411,
            413,
            415,
            417,
            419,
            421,
            423,
            425,
            427,
            429,
            431,
            433,
            435,
            437,
            439,
            441,
            443,
            445,
            447,
            449,
            451,
            454,
            456,
            458,
            460,
            463,
            465,
            467,
            469,
            472,
            474,
            476,
            478,
            480,
            482,
            484,
            486,
            489,
            491,
            493,
            495,
            497,
            499,
            501,
            503,
            505,
            507,
            509,
            511,
            513,
            515,
            517,
            519,
            521,
            523,
            525,
            527,
            529,
            531,
            533,
            535,
            537,
            540,
            542,
            544,
            546,
            548,
            550,
            552,
            554,
            556,
            558,
            560,
            562,
            564,
            566,
            568,
            570,
            572,
            574,
            577,
            579,
            582,
            584,
            586,
            588,
            590,
            592,
            594,
            597,
            599,
            601,
            603,
            605,
            607,
            609,
            611,
            613,
            615,
            617,
            619,
            622,
            624,
            626,
            628,
            630,
            632,
            635,
            637,
            639,
            641,
            643,
            645,
            647,
            649,
            651,
            653,
            655,
            657,
            659,
            661,
            663,
            665,
            667,
            669,
            671,
            673,
            675,
            677,
            679,
            681,
            683,
            685,
            687,
            689,
            691,
            694,
            696,
            698,
            700,
            702,
            704,
            707,
            709,
            711,
            713,
            715,
            717,
            721,
            723,
            725,
            727,
            730,
            732,
            734,
            736,
            739,
            741,
            743,
            745,
            747,
            749,
            752,
            754,
            756,
            758,
            760,
            762,
            764,
            766,
            768,
            770,
            772,
            775,
            777,
            779,
            781,
            784,
            786,
            788,
            790,
            792,
            794,
            796,
            798,
            800,
            802,
            804,
            806,
        ],
        dtype=torch.int32,
    )

    xcuda = x.to(device="cuda")
    segscuda = segs.to(device="cuda")
    y = extension.segscan_incl(x, segs)
    ycuda = extension.segscan_incl(xcuda, segscuda)
    torch.testing.assert_allclose(ycuda.to(device="cpu"), y)

    x = torch.ones(840, dtype=torch.float32)
    segs = torch.tensor(
        [
            0,
            2,
            8,
            10,
            12,
            14,
            20,
            22,
            24,
            26,
            31,
            33,
            35,
            37,
            44,
            46,
            48,
            50,
            54,
            56,
            58,
            60,
            67,
            69,
            71,
            73,
            77,
            79,
            81,
            83,
            88,
            90,
            92,
            94,
            98,
            100,
            102,
            104,
            106,
            108,
            110,
            112,
            119,
            121,
            123,
            125,
            129,
            131,
            133,
            135,
            140,
            142,
            144,
            146,
            150,
            152,
            154,
            156,
            161,
            163,
            165,
            167,
            172,
            174,
            176,
            178,
            182,
            184,
            186,
            188,
            193,
            195,
            197,
            202,
            204,
            206,
            208,
            212,
            214,
            216,
            218,
            222,
            224,
            226,
            228,
            232,
            234,
            236,
            238,
            243,
            245,
            247,
            249,
            254,
            256,
            258,
            260,
            265,
            267,
            269,
            271,
            275,
            277,
            279,
            281,
            288,
            290,
            292,
            294,
            297,
            299,
            301,
            303,
            310,
            312,
            314,
            316,
            321,
            323,
            325,
            327,
            333,
            335,
            337,
            339,
            343,
            345,
            347,
            349,
            356,
            358,
            360,
            362,
            367,
            369,
            371,
            373,
            375,
            377,
            379,
            381,
            386,
            388,
            390,
            393,
            397,
            399,
            401,
            406,
            408,
            410,
            412,
            416,
            418,
            420,
            422,
            428,
            430,
            432,
            434,
            440,
            442,
            444,
            446,
            454,
            456,
            458,
            460,
            465,
            467,
            469,
            471,
            476,
            478,
            480,
            482,
            490,
            492,
            494,
            496,
            498,
            501,
            503,
            505,
            507,
            509,
            511,
            513,
            520,
            522,
            524,
            526,
            532,
            534,
            536,
            538,
            543,
            545,
            547,
            549,
            554,
            556,
            558,
            560,
            564,
            566,
            568,
            570,
            572,
            574,
            576,
            578,
            586,
            588,
            590,
            592,
            596,
            598,
            600,
            602,
            607,
            609,
            611,
            613,
            617,
            619,
            621,
            623,
            627,
            629,
            631,
            633,
            642,
            644,
            646,
            648,
            653,
            655,
            657,
            659,
            664,
            666,
            668,
            670,
            676,
            678,
            680,
            682,
            689,
            691,
            693,
            695,
            700,
            702,
            704,
            706,
            710,
            712,
            714,
            716,
            720,
            722,
            724,
            726,
            731,
            733,
            735,
            737,
            743,
            745,
            747,
            749,
            754,
            756,
            758,
            760,
            764,
            766,
            768,
            770,
            775,
            777,
            779,
            781,
            789,
            791,
            793,
            795,
            800,
            802,
            804,
            806,
            815,
            817,
            819,
            821,
            823,
            825,
            827,
            829,
            831,
            834,
        ],
        dtype=torch.int32,
    )

    xcuda = x.to(device="cuda")
    segscuda = segs.to(device="cuda")
    y = extension.segscan_incl_128_2(x, segs)
    ycuda = extension.segscan_incl_128_2(xcuda, segscuda)
    torch.testing.assert_allclose(ycuda.to(device="cpu"), y)


@requires_cuda
def test_segscan_highly_segmented2(extension):
    # x = torch.ones(2530, dtype=torch.float32)
    #
    # segs = torch.tensor(
    #     [
    #            0,    27,   135,   144,   162,   165,   238,   241,   250,   253,
    #          280,   388,   397,   415,   418,   491,   494,   503,   506,   533,
    #          641,   650,   668,   671,   744,   747,   756,   759,   786,   894,
    #          903,   921,   924,   997,  1000,  1009,  1012,  1039,  1147,  1156,
    #         1174,  1177,  1250,  1253,  1262,  1265,  1292,  1400,  1409,  1427,
    #         1430,  1503,  1506,  1515,  1518,  1545,  1653,  1662,  1680,  1683,
    #         1756,  1759,  1768,  1771,  1798,  1906,  1915,  1933,  1936,  2009,
    #         2012,  2021,  2024,  2051,  2159,  2168,  2186,  2189,  2262,  2265,
    #         2274,  2277,  2304,  2412,  2421,  2439,  2442,  2515,  2518,  2527,
    #     ],
    #     dtype=torch.int32,
    # )

    x = torch.ones(506, dtype=torch.float32)

    segs = torch.tensor(
        [
            0,
            27,
            135,
            144,
            162,
            165,
            238,
            241,
            250,
            253,
            280,
            388,
            397,
            415,
            418,
            491,
            494,
            503,
        ],
        dtype=torch.int32,
    )

    xcuda = x.to(device="cuda")
    segscuda = segs.to(device="cuda")
    y = extension.segscan_excl(x, segs)
    ycuda = extension.segscan_excl(xcuda, segscuda)
    # print("y cpu")
    # print(y)
    # print("y cuda")
    # print(ycuda.cpu())
    torch.testing.assert_allclose(ycuda.to(device="cpu"), y)


def highly_segmented3():
    return torch.tensor(
        [
            0,
            8,
            16,
            24,
            32,
            40,
            48,
            56,
            64,
            72,
            80,
            88,
            96,
            104,
            112,
            120,
            128,
            136,
            144,
            152,
            160,
            168,
            176,
            184,
            192,
            200,
            208,
            216,
            224,
            232,
            240,
            248,
            256,
            264,
            272,
            280,
            288,
            296,
            304,
            312,
            319,
            326,
            333,
            344,
            355,
            366,
            377,
            388,
            394,
            400,
            409,
            418,
            427,
            436,
            445,
            454,
            463,
            472,
            481,
            490,
            499,
            508,
            517,
            526,
            535,
            544,
            553,
            562,
            568,
            574,
            581,
            588,
            595,
            602,
            608,
            614,
            619,
            628,
            637,
            646,
            655,
            664,
            673,
            682,
            691,
            700,
            709,
            718,
            727,
            736,
            745,
            754,
            763,
            772,
            781,
            787,
            793,
            800,
            807,
            814,
            820,
            826,
            833,
            840,
            847,
            854,
            861,
            868,
            875,
            882,
            889,
            896,
            903,
            910,
            917,
            924,
            931,
            938,
            945,
            952,
            959,
            966,
            973,
            980,
            987,
            994,
            1001,
            1007,
            1013,
            1020,
            1027,
            1034,
            1041,
            1048,
            1055,
            1062,
            1069,
            1076,
            1083,
            1090,
            1097,
            1104,
            1111,
            1118,
            1125,
            1132,
            1139,
            1146,
            1153,
            1160,
            1167,
            1173,
            1179,
            1185,
            1191,
            1197,
            1203,
            1209,
            1215,
            1221,
            1227,
            1233,
            1239,
            1245,
            1251,
            1257,
            1264,
            1271,
            1278,
            1285,
            1292,
            1299,
            1306,
            1313,
            1320,
            1327,
            1334,
            1341,
            1348,
            1355,
            1362,
            1369,
            1376,
            1383,
            1390,
            1397,
            1404,
            1411,
            1418,
            1425,
            1432,
            1439,
            1446,
            1453,
            1460,
            1467,
            1474,
            1481,
            1488,
            1495,
            1502,
            1509,
            1516,
            1523,
            1530,
            1537,
            1544,
            1550,
            1556,
            1565,
            1574,
            1583,
            1592,
            1601,
            1610,
            1619,
            1628,
            1637,
            1646,
            1655,
            1664,
            1673,
            1682,
            1691,
            1700,
            1709,
            1718,
            1723,
            1732,
            1741,
            1750,
            1759,
            1768,
            1777,
            1786,
            1795,
            1804,
            1813,
            1822,
            1831,
            1840,
            1849,
            1858,
            1867,
            1876,
            1885,
            1892,
            1899,
            1906,
            1914,
            1922,
            1930,
            1938,
            1946,
            1954,
            1962,
            1970,
            1978,
            1986,
            1994,
            2002,
            2010,
            2018,
            2026,
            2034,
            2042,
            2050,
            2058,
            2066,
            2074,
            2082,
            2090,
            2098,
            2106,
            2114,
            2122,
            2128,
            2134,
            2140,
            2146,
            2152,
            2158,
            2164,
            2170,
            2176,
            2182,
            2188,
            2197,
            2206,
            2215,
            2224,
            2233,
            2242,
            2251,
            2260,
            2269,
            2278,
            2287,
            2296,
            2305,
            2314,
            2323,
            2332,
            2341,
            2350,
            2357,
            2364,
            2371,
            2378,
            2385,
            2392,
            2399,
            2406,
            2413,
            2420,
            2427,
            2434,
            2441,
            2448,
            2455,
            2462,
            2469,
            2476,
            2483,
            2490,
            2497,
            2502,
            2509,
            2516,
            2523,
            2530,
            2537,
            2543,
            2549,
            2555,
            2561,
            2567,
            2573,
            2579,
            2585,
            2591,
            2597,
            2603,
            2611,
            2619,
            2627,
            2635,
            2643,
            2651,
            2659,
            2667,
            2675,
            2683,
            2691,
            2699,
            2707,
            2715,
            2723,
            2731,
            2739,
            2747,
            2755,
            2763,
            2771,
            2779,
            2787,
            2795,
            2803,
            2811,
            2819,
            2827,
            2835,
            2843,
            2851,
            2859,
            2867,
            2875,
            2883,
            2891,
            2899,
            2907,
            2915,
            2923,
            2931,
            2939,
            2947,
            2955,
            2963,
            2971,
            2979,
            2987,
            2995,
            3003,
            3011,
            3019,
            3027,
            3035,
            3045,
            3055,
            3065,
            3075,
            3085,
            3095,
            3105,
            3115,
            3125,
            3135,
            3145,
            3155,
            3165,
            3175,
            3185,
            3195,
            3205,
            3215,
            3222,
            3229,
            3236,
            3243,
            3250,
            3257,
            3264,
            3275,
            3286,
            3297,
            3308,
            3319,
            3324,
            3329,
            3338,
            3347,
            3356,
            3365,
            3374,
            3383,
            3392,
            3401,
            3410,
            3419,
            3428,
            3437,
            3446,
            3455,
            3464,
            3473,
            3482,
            3491,
            3499,
            3507,
            3515,
            3523,
            3531,
            3539,
            3547,
            3555,
            3563,
            3571,
            3579,
            3587,
            3595,
            3603,
            3611,
            3619,
            3627,
            3635,
            3643,
            3651,
            3659,
            3667,
            3675,
            3683,
            3691,
            3699,
            3707,
            3714,
            3721,
            3728,
            3735,
            3742,
            3749,
            3756,
            3763,
            3770,
            3777,
            3784,
            3791,
            3798,
            3805,
            3812,
            3819,
            3826,
            3833,
            3840,
            3847,
            3854,
            3861,
            3868,
            3875,
            3882,
            3888,
            3894,
            3900,
            3906,
            3912,
            3918,
            3924,
            3930,
            3936,
            3942,
            3948,
            3953,
            3963,
            3973,
            3983,
            3993,
            4003,
            4013,
            4023,
            4033,
            4043,
            4053,
            4063,
            4073,
            4083,
            4093,
            4103,
            4113,
            4123,
            4133,
            4139,
            4145,
            4152,
            4159,
            4166,
            4173,
            4179,
            4185,
            4191,
            4197,
            4203,
            4209,
            4215,
            4221,
            4227,
            4233,
            4239,
            4245,
            4251,
            4262,
            4273,
            4284,
            4295,
            4306,
            4313,
            4320,
            4327,
            4334,
            4341,
            4348,
            4355,
            4362,
            4369,
            4376,
            4383,
            4390,
            4397,
            4404,
            4411,
            4418,
            4425,
            4432,
            4439,
            4446,
            4454,
            4462,
            4470,
            4478,
            4486,
            4494,
            4502,
            4510,
            4518,
            4526,
            4534,
            4542,
            4550,
            4558,
            4566,
            4574,
            4582,
            4590,
            4598,
            4606,
            4614,
            4622,
            4630,
            4638,
            4646,
            4654,
            4662,
            4671,
            4680,
            4689,
            4698,
            4707,
            4716,
            4725,
            4734,
            4743,
            4752,
            4761,
            4770,
            4779,
            4788,
            4797,
            4806,
            4815,
            4824,
            4831,
            4838,
            4845,
            4852,
            4859,
            4866,
            4873,
            4880,
            4887,
            4894,
            4901,
            4908,
            4915,
            4922,
            4929,
            4936,
            4943,
            4950,
            4957,
            4964,
            4971,
            4977,
            4983,
            4989,
            4995,
            5002,
            5009,
            5016,
            5023,
            5032,
            5041,
            5050,
            5059,
            5068,
            5077,
            5086,
            5095,
            5104,
            5113,
            5122,
            5132,
            5142,
            5152,
            5162,
            5172,
            5182,
            5192,
            5202,
            5212,
            5222,
            5232,
            5239,
            5246,
            5253,
            5260,
            5266,
            5272,
            5279,
            5286,
            5293,
            5300,
            5310,
            5320,
            5330,
            5340,
            5350,
            5360,
            5370,
            5380,
            5390,
            5400,
            5410,
            5420,
            5430,
            5440,
            5450,
            5460,
            5470,
            5480,
            5487,
            5494,
            5501,
            5508,
            5518,
            5528,
            5538,
            5548,
            5558,
            5568,
            5578,
            5588,
            5598,
            5608,
            5618,
            5628,
            5638,
            5648,
            5658,
            5668,
            5678,
            5688,
            5693,
            5698,
            5706,
            5714,
            5722,
            5730,
            5738,
            5746,
            5754,
            5762,
            5770,
            5778,
            5786,
            5794,
            5802,
            5810,
            5818,
            5826,
            5834,
            5842,
            5850,
            5858,
            5866,
            5874,
            5882,
            5890,
            5898,
            5906,
            5914,
            5922,
            5930,
            5938,
            5946,
            5954,
            5962,
            5970,
            5978,
            5986,
            5994,
            6002,
            6010,
            6017,
            6024,
            6031,
            6042,
            6053,
            6064,
            6075,
            6086,
            6092,
            6098,
            6107,
            6116,
            6125,
            6134,
            6143,
            6152,
            6161,
            6170,
            6179,
            6188,
            6197,
            6206,
            6215,
            6224,
            6233,
            6242,
            6251,
            6260,
            6266,
            6272,
            6279,
            6286,
            6293,
            6300,
            6306,
            6312,
            6317,
            6326,
            6335,
            6344,
            6353,
            6362,
            6371,
            6380,
            6389,
            6398,
            6407,
            6416,
            6425,
            6434,
            6443,
            6452,
            6461,
            6470,
            6479,
            6485,
            6491,
            6498,
            6505,
            6512,
            6518,
            6524,
            6531,
            6538,
            6545,
            6552,
            6559,
            6566,
            6573,
            6580,
            6587,
            6594,
            6601,
            6608,
            6615,
            6622,
            6629,
            6636,
            6643,
            6650,
            6657,
            6664,
            6671,
            6678,
            6685,
            6692,
            6699,
            6705,
            6711,
            6718,
            6725,
            6732,
            6739,
            6746,
            6753,
            6760,
            6767,
            6774,
            6781,
            6788,
            6795,
            6802,
            6809,
            6816,
            6823,
            6830,
            6837,
            6844,
            6851,
            6858,
            6865,
            6871,
            6877,
            6883,
            6889,
            6895,
            6901,
            6907,
            6913,
            6919,
            6925,
            6931,
            6937,
            6943,
            6949,
            6955,
            6962,
            6969,
            6976,
            6983,
            6990,
            6997,
            7004,
            7011,
            7018,
            7025,
            7032,
            7039,
            7046,
            7053,
            7060,
            7067,
            7074,
            7081,
            7088,
            7095,
            7102,
            7109,
            7116,
            7123,
            7130,
            7137,
            7144,
            7151,
            7158,
            7165,
            7172,
            7179,
            7186,
            7193,
            7200,
            7207,
            7214,
            7221,
            7228,
            7235,
            7242,
            7248,
            7254,
            7263,
            7272,
            7281,
            7290,
            7299,
            7308,
            7317,
            7326,
            7335,
            7344,
            7353,
            7362,
            7371,
            7380,
            7389,
            7398,
            7407,
            7416,
            7421,
            7430,
            7439,
            7448,
            7457,
            7466,
            7475,
            7484,
            7493,
            7502,
            7511,
            7520,
            7529,
            7538,
            7547,
            7556,
            7565,
            7574,
            7583,
            7590,
            7597,
            7604,
            7612,
            7620,
            7628,
            7636,
            7644,
            7652,
            7660,
            7668,
            7676,
            7684,
            7692,
            7700,
            7708,
            7716,
            7724,
            7732,
            7740,
            7748,
            7756,
            7764,
            7772,
            7780,
            7788,
            7796,
            7804,
            7812,
            7820,
            7826,
            7832,
            7838,
            7844,
            7850,
            7856,
            7862,
            7868,
            7874,
            7880,
            7886,
            7895,
            7904,
            7913,
            7922,
            7931,
            7940,
            7949,
            7958,
            7967,
            7976,
            7985,
            7994,
            8003,
            8012,
            8021,
            8030,
            8039,
            8048,
            8055,
            8062,
            8069,
            8076,
            8083,
            8090,
            8097,
            8104,
            8111,
            8118,
            8125,
            8132,
            8139,
            8146,
            8153,
            8160,
            8167,
            8174,
            8181,
            8188,
            8195,
            8200,
            8207,
            8214,
            8221,
            8228,
            8235,
            8241,
            8247,
            8253,
            8259,
            8265,
            8271,
            8277,
            8283,
            8289,
            8295,
            8301,
            8309,
            8317,
            8325,
            8333,
            8341,
            8349,
            8357,
            8365,
            8373,
            8381,
            8389,
            8397,
            8405,
            8413,
            8421,
            8429,
            8437,
            8445,
            8453,
            8461,
            8469,
            8477,
            8485,
            8493,
            8501,
            8509,
            8517,
            8525,
            8533,
            8541,
            8549,
            8557,
            8565,
            8573,
            8581,
            8589,
            8597,
            8605,
            8613,
            8621,
            8629,
            8637,
            8645,
            8653,
            8661,
            8669,
            8677,
            8685,
            8693,
            8701,
            8709,
            8717,
            8725,
            8733,
            8743,
            8753,
            8763,
            8773,
            8783,
            8793,
            8803,
            8813,
            8823,
            8833,
            8843,
            8853,
            8863,
            8873,
            8883,
            8893,
            8903,
            8913,
            8920,
            8927,
            8934,
            8941,
            8948,
            8955,
            8962,
            8973,
            8984,
            8995,
            9006,
            9017,
            9022,
            9027,
            9036,
            9045,
            9054,
            9063,
            9072,
            9081,
            9090,
            9099,
            9108,
            9117,
            9126,
            9135,
            9144,
            9153,
            9162,
            9171,
            9180,
            9189,
            9197,
            9205,
            9213,
            9221,
            9229,
            9237,
            9245,
            9253,
            9261,
            9269,
            9277,
            9285,
            9293,
            9301,
            9309,
            9317,
            9325,
            9333,
            9341,
            9349,
            9357,
            9365,
            9373,
            9381,
            9389,
            9397,
            9405,
            9412,
            9419,
            9426,
            9433,
            9440,
            9447,
            9454,
            9461,
            9468,
            9475,
            9482,
            9489,
            9496,
            9503,
            9510,
            9517,
            9524,
            9531,
            9538,
            9545,
            9552,
            9559,
            9566,
            9573,
            9580,
            9586,
            9592,
            9598,
            9604,
            9610,
            9616,
            9622,
            9628,
            9634,
            9640,
            9646,
            9651,
            9661,
            9671,
            9681,
            9691,
            9701,
            9711,
            9721,
            9731,
            9741,
            9751,
            9761,
            9771,
            9781,
            9791,
            9801,
            9811,
            9821,
            9831,
            9837,
            9843,
            9850,
            9857,
            9864,
            9871,
            9877,
            9883,
            9889,
            9895,
            9901,
            9907,
            9913,
            9919,
            9925,
            9931,
            9937,
            9943,
            9949,
            9960,
            9971,
            9982,
            9993,
            10004,
            10011,
            10018,
            10025,
            10032,
            10039,
            10046,
            10053,
            10060,
            10067,
            10074,
            10081,
            10088,
            10095,
            10102,
            10109,
            10116,
            10123,
            10130,
            10137,
            10144,
            10152,
            10160,
            10168,
            10176,
            10184,
            10192,
            10200,
            10208,
            10216,
            10224,
            10232,
            10240,
            10248,
            10256,
            10264,
            10272,
            10280,
            10288,
            10296,
            10304,
            10312,
            10320,
            10328,
            10336,
            10344,
            10352,
            10360,
            10369,
            10378,
            10387,
            10396,
            10405,
            10414,
            10423,
            10432,
            10441,
            10450,
            10459,
            10468,
            10477,
            10486,
            10495,
            10504,
            10513,
            10522,
            10529,
            10536,
            10543,
            10550,
            10557,
            10564,
            10571,
            10578,
            10585,
            10592,
            10599,
            10606,
            10613,
            10620,
            10627,
            10634,
            10641,
            10648,
            10655,
            10662,
            10669,
            10675,
            10681,
            10687,
            10693,
            10700,
            10707,
            10714,
            10721,
            10730,
            10739,
            10748,
            10757,
            10766,
            10775,
            10784,
            10793,
            10802,
            10811,
            10820,
            10830,
            10840,
            10850,
            10860,
            10870,
            10880,
            10890,
            10900,
            10910,
            10920,
            10930,
            10937,
            10944,
            10951,
            10958,
            10964,
            10970,
            10977,
            10984,
            10991,
            10998,
            11008,
            11018,
            11028,
            11038,
            11048,
            11058,
            11068,
            11078,
            11088,
            11098,
            11108,
            11118,
            11128,
            11138,
            11148,
            11158,
            11168,
            11178,
            11185,
            11192,
            11199,
            11206,
            11216,
            11226,
            11236,
            11246,
            11256,
            11266,
            11276,
            11286,
            11296,
            11306,
            11316,
            11326,
            11336,
            11346,
            11356,
            11366,
            11376,
            11386,
            11391,
            11396,
            11404,
            11412,
            11420,
            11428,
            11436,
            11444,
            11452,
            11460,
            11468,
            11476,
            11484,
            11492,
            11500,
            11508,
            11516,
            11524,
            11532,
            11540,
            11548,
            11556,
            11564,
            11572,
            11580,
            11588,
            11596,
            11604,
            11612,
            11620,
            11628,
            11636,
            11644,
            11652,
            11660,
            11668,
            11676,
            11684,
            11692,
            11700,
            11708,
            11715,
            11722,
            11729,
            11740,
            11751,
            11762,
            11773,
            11784,
            11790,
            11796,
            11805,
            11814,
            11823,
            11832,
            11841,
            11850,
            11859,
            11868,
            11877,
            11886,
            11895,
            11904,
            11913,
            11922,
            11931,
            11940,
            11949,
            11958,
            11964,
            11970,
            11977,
            11984,
            11991,
            11998,
            12004,
            12010,
            12015,
            12024,
            12033,
            12042,
            12051,
            12060,
            12069,
            12078,
            12087,
            12096,
            12105,
            12114,
            12123,
            12132,
            12141,
            12150,
            12159,
            12168,
            12177,
            12183,
            12189,
            12196,
            12203,
            12210,
            12216,
            12222,
            12229,
            12236,
            12243,
            12250,
            12257,
            12264,
            12271,
            12278,
            12285,
            12292,
            12299,
            12306,
            12313,
            12320,
            12327,
            12334,
            12341,
            12348,
            12355,
            12362,
            12369,
            12376,
            12383,
            12390,
            12397,
            12403,
            12409,
            12416,
            12423,
            12430,
            12437,
            12444,
            12451,
            12458,
            12465,
            12472,
            12479,
            12486,
            12493,
            12500,
            12507,
            12514,
            12521,
            12528,
            12535,
            12542,
            12549,
            12556,
            12563,
            12569,
            12575,
            12581,
            12587,
            12593,
            12599,
            12605,
            12611,
            12617,
            12623,
            12629,
            12635,
            12641,
            12647,
            12653,
            12660,
            12667,
            12674,
            12681,
            12688,
            12695,
            12702,
            12709,
            12716,
            12723,
            12730,
            12737,
            12744,
            12751,
            12758,
            12765,
            12772,
            12779,
            12786,
            12793,
            12800,
            12807,
            12814,
            12821,
            12828,
            12835,
            12842,
            12849,
            12856,
            12863,
            12870,
            12877,
            12884,
            12891,
            12898,
            12905,
            12912,
            12919,
            12926,
            12933,
            12940,
            12946,
            12952,
            12961,
            12970,
            12979,
            12988,
            12997,
            13006,
            13015,
            13024,
            13033,
            13042,
            13051,
            13060,
            13069,
            13078,
            13087,
            13096,
            13105,
            13114,
            13119,
            13128,
            13137,
            13146,
            13155,
            13164,
            13173,
            13182,
            13191,
            13200,
            13209,
            13218,
            13227,
            13236,
            13245,
            13254,
            13263,
            13272,
            13281,
            13288,
            13295,
            13302,
            13310,
            13318,
            13326,
            13334,
            13342,
            13350,
            13358,
            13366,
            13374,
            13382,
            13390,
            13398,
            13406,
            13414,
            13422,
            13430,
            13438,
            13446,
            13454,
            13462,
            13470,
            13478,
            13486,
            13494,
            13502,
            13510,
            13518,
            13524,
            13530,
            13536,
            13542,
            13548,
            13554,
            13560,
            13566,
            13572,
            13578,
            13584,
            13593,
            13602,
            13611,
            13620,
            13629,
            13638,
            13647,
            13656,
            13665,
            13674,
            13683,
            13692,
            13701,
            13710,
            13719,
            13728,
            13737,
            13746,
            13753,
            13760,
            13767,
            13774,
            13781,
            13788,
            13795,
            13802,
            13809,
            13816,
            13823,
            13830,
            13837,
            13844,
            13851,
            13858,
            13865,
            13872,
            13879,
            13886,
            13893,
            13898,
            13905,
            13912,
            13919,
            13926,
            13933,
            13939,
            13945,
            13951,
            13957,
            13963,
            13969,
            13975,
            13981,
            13987,
            13993,
            13999,
            14007,
            14015,
            14023,
            14031,
            14039,
            14047,
            14055,
            14063,
            14071,
            14079,
            14087,
            14095,
            14103,
            14111,
            14119,
            14127,
            14135,
            14143,
            14151,
            14159,
            14167,
            14175,
            14183,
            14191,
            14199,
            14207,
            14215,
            14223,
            14231,
            14239,
            14247,
            14255,
            14263,
            14271,
            14279,
            14287,
            14295,
            14303,
            14311,
            14319,
            14327,
            14335,
            14343,
            14351,
            14359,
            14367,
            14375,
            14383,
            14391,
            14399,
            14407,
            14415,
            14423,
            14431,
            14441,
            14451,
            14461,
            14471,
            14481,
            14491,
            14501,
            14511,
            14521,
            14531,
            14541,
            14551,
            14561,
            14571,
            14581,
            14591,
            14601,
            14611,
            14618,
            14625,
            14632,
            14639,
            14646,
            14653,
            14660,
            14671,
            14682,
            14693,
            14704,
            14715,
            14720,
            14725,
            14734,
            14743,
            14752,
            14761,
            14770,
            14779,
            14788,
            14797,
            14806,
            14815,
            14824,
            14833,
            14842,
            14851,
            14860,
            14869,
            14878,
            14887,
            14895,
            14903,
            14911,
            14919,
            14927,
            14935,
            14943,
            14951,
            14959,
            14967,
            14975,
            14983,
            14991,
            14999,
            15007,
            15015,
            15023,
            15031,
            15039,
            15047,
            15055,
            15063,
            15071,
            15079,
            15087,
            15095,
            15103,
            15110,
            15117,
            15124,
            15131,
            15138,
            15145,
            15152,
            15159,
            15166,
            15173,
            15180,
            15187,
            15194,
            15201,
            15208,
            15215,
            15222,
            15229,
            15236,
            15243,
            15250,
            15257,
            15264,
            15271,
            15278,
            15284,
            15290,
            15296,
            15302,
            15308,
            15314,
            15320,
            15326,
            15332,
            15338,
            15344,
            15349,
            15359,
            15369,
            15379,
            15389,
            15399,
            15409,
            15419,
            15429,
            15439,
            15449,
            15459,
            15469,
            15479,
            15489,
            15499,
            15509,
            15519,
            15529,
            15535,
            15541,
            15548,
            15555,
            15562,
            15569,
            15575,
            15581,
            15587,
            15593,
            15599,
            15605,
            15611,
            15617,
            15623,
            15629,
            15635,
            15641,
            15647,
            15658,
            15669,
            15680,
            15691,
            15702,
            15709,
            15716,
            15723,
            15730,
            15737,
            15744,
            15751,
            15758,
            15765,
            15772,
            15779,
            15786,
            15793,
            15800,
            15807,
            15814,
            15821,
            15828,
            15835,
            15842,
            15850,
            15858,
            15866,
            15874,
            15882,
            15890,
            15898,
            15906,
            15914,
            15922,
            15930,
            15938,
            15946,
            15954,
            15962,
            15970,
            15978,
            15986,
            15994,
            16002,
            16010,
            16018,
            16026,
            16034,
            16042,
            16050,
            16058,
            16067,
            16076,
            16085,
            16094,
            16103,
            16112,
            16121,
            16130,
            16139,
            16148,
            16157,
            16166,
            16175,
            16184,
            16193,
            16202,
            16211,
            16220,
            16227,
            16234,
            16241,
            16248,
            16255,
            16262,
            16269,
            16276,
            16283,
            16290,
            16297,
            16304,
            16311,
            16318,
            16325,
            16332,
            16339,
            16346,
            16353,
            16360,
            16367,
            16373,
            16379,
            16385,
            16391,
            16398,
            16405,
            16412,
            16419,
            16428,
            16437,
            16446,
            16455,
            16464,
            16473,
            16482,
            16491,
            16500,
            16509,
            16518,
            16528,
            16538,
            16548,
            16558,
            16568,
            16578,
            16588,
            16598,
            16608,
            16618,
            16628,
            16635,
            16642,
            16649,
            16656,
            16662,
            16668,
            16675,
            16682,
            16689,
            16696,
            16706,
            16716,
            16726,
            16736,
            16746,
            16756,
            16766,
            16776,
            16786,
            16796,
            16806,
            16816,
            16826,
            16836,
            16846,
            16856,
            16866,
            16876,
            16883,
            16890,
            16897,
            16904,
            16914,
            16924,
            16934,
            16944,
            16954,
            16964,
            16974,
            16984,
            16994,
            17004,
            17014,
            17024,
            17034,
            17044,
            17054,
            17064,
            17074,
            17084,
            17089,
            17094,
            17102,
            17110,
            17118,
            17126,
            17134,
            17142,
            17150,
            17158,
            17166,
            17174,
            17182,
            17190,
            17198,
            17206,
            17214,
            17222,
            17230,
            17238,
            17246,
            17254,
            17262,
            17270,
            17278,
            17286,
            17294,
            17302,
            17310,
            17318,
            17326,
            17334,
            17342,
            17350,
            17358,
            17366,
            17374,
            17382,
            17390,
            17398,
            17406,
            17413,
            17420,
            17427,
            17438,
            17449,
            17460,
            17471,
            17482,
            17488,
            17494,
            17503,
            17512,
            17521,
            17530,
            17539,
            17548,
            17557,
            17566,
            17575,
            17584,
            17593,
            17602,
            17611,
            17620,
            17629,
            17638,
            17647,
            17656,
            17662,
            17668,
            17675,
            17682,
            17689,
            17696,
            17702,
            17708,
            17713,
            17722,
            17731,
            17740,
            17749,
            17758,
            17767,
            17776,
            17785,
            17794,
            17803,
            17812,
            17821,
            17830,
            17839,
            17848,
            17857,
            17866,
            17875,
            17881,
            17887,
            17894,
            17901,
            17908,
            17914,
            17920,
            17927,
            17934,
            17941,
            17948,
            17955,
            17962,
            17969,
            17976,
            17983,
            17990,
            17997,
            18004,
            18011,
            18018,
            18025,
            18032,
            18039,
            18046,
            18053,
            18060,
            18067,
            18074,
            18081,
            18088,
            18095,
            18101,
            18107,
            18114,
            18121,
            18128,
            18135,
            18142,
            18149,
            18156,
            18163,
            18170,
            18177,
            18184,
            18191,
            18198,
            18205,
            18212,
            18219,
            18226,
            18233,
            18240,
            18247,
            18254,
            18261,
            18267,
            18273,
            18279,
            18285,
            18291,
            18297,
            18303,
            18309,
            18315,
            18321,
            18327,
            18333,
            18339,
            18345,
            18351,
            18358,
            18365,
            18372,
            18379,
            18386,
            18393,
            18400,
            18407,
            18414,
            18421,
            18428,
            18435,
            18442,
            18449,
            18456,
            18463,
            18470,
            18477,
            18484,
            18491,
            18498,
            18505,
            18512,
            18519,
            18526,
            18533,
            18540,
            18547,
            18554,
            18561,
            18568,
            18575,
            18582,
            18589,
            18596,
            18603,
            18610,
            18617,
            18624,
            18631,
            18638,
            18644,
            18650,
            18659,
            18668,
            18677,
            18686,
            18695,
            18704,
            18713,
            18722,
            18731,
            18740,
            18749,
            18758,
            18767,
            18776,
            18785,
            18794,
            18803,
            18812,
            18817,
            18826,
            18835,
            18844,
            18853,
            18862,
            18871,
            18880,
            18889,
            18898,
            18907,
            18916,
            18925,
            18934,
            18943,
            18952,
            18961,
            18970,
            18979,
            18986,
            18993,
            19000,
            19008,
            19016,
            19024,
            19032,
            19040,
            19048,
            19056,
            19064,
            19072,
            19080,
            19088,
            19096,
            19104,
            19112,
            19120,
            19128,
            19136,
            19144,
            19152,
            19160,
            19168,
            19176,
            19184,
            19192,
            19200,
            19208,
            19216,
            19222,
            19228,
            19234,
            19240,
            19246,
            19252,
            19258,
            19264,
            19270,
            19276,
            19282,
            19291,
            19300,
            19309,
            19318,
            19327,
            19336,
            19345,
            19354,
            19363,
            19372,
            19381,
            19390,
            19399,
            19408,
            19417,
            19426,
            19435,
            19444,
            19451,
            19458,
            19465,
            19472,
            19479,
            19486,
            19493,
            19500,
            19507,
            19514,
            19521,
            19528,
            19535,
            19542,
            19549,
            19556,
            19563,
            19570,
            19577,
            19584,
            19591,
            19596,
            19603,
            19610,
            19617,
            19624,
            19631,
            19637,
            19643,
            19649,
            19655,
            19661,
            19667,
            19673,
            19679,
            19685,
            19691,
            19697,
            19705,
            19713,
            19721,
            19729,
            19737,
            19745,
            19753,
            19761,
            19769,
            19777,
            19785,
            19793,
            19801,
            19809,
            19817,
            19825,
            19833,
            19841,
            19849,
            19857,
            19865,
            19873,
            19881,
            19889,
            19897,
            19905,
            19913,
            19921,
            19929,
            19937,
            19945,
            19953,
            19961,
            19969,
            19977,
            19985,
            19993,
            20001,
            20009,
            20017,
            20025,
            20033,
            20041,
            20049,
            20057,
            20065,
            20073,
            20081,
            20089,
            20097,
            20105,
            20113,
            20121,
            20129,
            20139,
            20149,
            20159,
            20169,
            20179,
            20189,
            20199,
            20209,
            20219,
            20229,
            20239,
            20249,
            20259,
            20269,
            20279,
            20289,
            20299,
            20309,
            20316,
            20323,
            20330,
            20337,
            20344,
            20351,
            20358,
            20369,
            20380,
            20391,
            20402,
            20413,
            20418,
            20423,
            20432,
            20441,
            20450,
            20459,
            20468,
            20477,
            20486,
            20495,
            20504,
            20513,
            20522,
            20531,
            20540,
            20549,
            20558,
            20567,
            20576,
            20585,
            20593,
            20601,
            20609,
            20617,
            20625,
            20633,
            20641,
            20649,
            20657,
            20665,
            20673,
            20681,
            20689,
            20697,
            20705,
            20713,
            20721,
            20729,
            20737,
            20745,
            20753,
            20761,
            20769,
            20777,
            20785,
            20793,
            20801,
            20808,
            20815,
            20822,
            20829,
            20836,
            20843,
            20850,
            20857,
            20864,
            20871,
            20878,
            20885,
            20892,
            20899,
            20906,
            20913,
            20920,
            20927,
            20934,
            20941,
            20948,
            20955,
            20962,
            20969,
            20976,
            20982,
            20988,
            20994,
            21000,
            21006,
            21012,
            21018,
            21024,
            21030,
            21036,
            21042,
            21047,
            21057,
            21067,
            21077,
            21087,
            21097,
            21107,
            21117,
            21127,
            21137,
            21147,
            21157,
            21167,
            21177,
            21187,
            21197,
            21207,
            21217,
            21227,
            21233,
            21239,
            21246,
            21253,
            21260,
            21267,
            21273,
            21279,
            21285,
            21291,
            21297,
            21303,
            21309,
            21315,
            21321,
            21327,
            21333,
            21339,
            21345,
            21356,
            21367,
            21378,
            21389,
            21400,
            21407,
            21414,
            21421,
            21428,
            21435,
            21442,
            21449,
            21456,
            21463,
            21470,
            21477,
            21484,
            21491,
            21498,
            21505,
            21512,
            21519,
            21526,
            21533,
            21540,
            21548,
            21556,
            21564,
            21572,
            21580,
            21588,
            21596,
            21604,
            21612,
            21620,
            21628,
            21636,
            21644,
            21652,
            21660,
            21668,
            21676,
            21684,
            21692,
            21700,
            21708,
            21716,
            21724,
            21732,
            21740,
            21748,
            21756,
            21765,
            21774,
            21783,
            21792,
            21801,
            21810,
            21819,
            21828,
            21837,
            21846,
            21855,
            21864,
            21873,
            21882,
            21891,
            21900,
            21909,
            21918,
            21925,
            21932,
            21939,
            21946,
            21953,
            21960,
            21967,
            21974,
            21981,
            21988,
            21995,
            22002,
            22009,
            22016,
            22023,
            22030,
            22037,
            22044,
            22051,
            22058,
            22065,
            22071,
            22077,
            22083,
            22089,
            22096,
            22103,
            22110,
            22117,
            22126,
            22135,
            22144,
            22153,
            22162,
            22171,
            22180,
            22189,
            22198,
            22207,
            22216,
            22226,
            22236,
            22246,
            22256,
            22266,
            22276,
            22286,
            22296,
            22306,
            22316,
            22326,
            22333,
            22340,
            22347,
            22354,
            22360,
            22366,
            22373,
            22380,
            22387,
            22394,
            22404,
            22414,
            22424,
            22434,
            22444,
            22454,
            22464,
            22474,
            22484,
            22494,
            22504,
            22514,
            22524,
            22534,
            22544,
            22554,
            22564,
            22574,
            22581,
            22588,
            22595,
            22602,
            22612,
            22622,
            22632,
            22642,
            22652,
            22662,
            22672,
            22682,
            22692,
            22702,
            22712,
            22722,
            22732,
            22742,
            22752,
            22762,
            22772,
            22782,
            22787,
            22792,
            22800,
            22808,
            22816,
            22824,
            22832,
            22840,
            22848,
            22856,
            22864,
            22872,
            22880,
            22888,
            22896,
            22904,
            22912,
            22920,
            22928,
            22936,
            22944,
            22952,
            22960,
            22968,
            22976,
            22984,
            22992,
            23000,
            23008,
            23016,
            23024,
            23032,
            23040,
            23048,
            23056,
            23064,
            23072,
            23080,
            23088,
            23096,
            23104,
            23111,
            23118,
            23125,
            23136,
            23147,
            23158,
            23169,
            23180,
            23186,
            23192,
            23201,
            23210,
            23219,
            23228,
            23237,
            23246,
            23255,
            23264,
            23273,
            23282,
            23291,
            23300,
            23309,
            23318,
            23327,
            23336,
            23345,
            23354,
            23360,
            23366,
            23373,
            23380,
            23387,
            23394,
            23400,
            23406,
            23411,
            23420,
            23429,
            23438,
            23447,
            23456,
            23465,
            23474,
            23483,
            23492,
            23501,
            23510,
            23519,
            23528,
            23537,
            23546,
            23555,
            23564,
            23573,
            23579,
            23585,
            23592,
            23599,
            23606,
            23612,
            23618,
            23625,
            23632,
            23639,
            23646,
            23653,
            23660,
            23667,
            23674,
            23681,
            23688,
            23695,
            23702,
            23709,
            23716,
            23723,
            23730,
            23737,
            23744,
            23751,
            23758,
            23765,
            23772,
            23779,
            23786,
            23793,
            23799,
            23805,
            23812,
            23819,
            23826,
            23833,
            23840,
            23847,
            23854,
            23861,
            23868,
            23875,
            23882,
            23889,
            23896,
            23903,
            23910,
            23917,
            23924,
            23931,
            23938,
            23945,
            23952,
            23959,
            23965,
            23971,
            23977,
            23983,
            23989,
            23995,
            24001,
            24007,
            24013,
            24019,
            24025,
            24031,
            24037,
            24043,
            24049,
            24056,
            24063,
            24070,
            24077,
            24084,
            24091,
            24098,
            24105,
            24112,
            24119,
            24126,
            24133,
            24140,
            24147,
            24154,
            24161,
            24168,
            24175,
            24182,
            24189,
            24196,
            24203,
            24210,
            24217,
            24224,
            24231,
            24238,
            24245,
            24252,
            24259,
            24266,
            24273,
            24280,
            24287,
            24294,
            24301,
            24308,
            24315,
            24322,
            24329,
            24336,
            24342,
            24348,
            24357,
            24366,
            24375,
            24384,
            24393,
            24402,
            24411,
            24420,
            24429,
            24438,
            24447,
            24456,
            24465,
            24474,
            24483,
            24492,
            24501,
            24510,
            24515,
            24524,
            24533,
            24542,
            24551,
            24560,
            24569,
            24578,
            24587,
            24596,
            24605,
            24614,
            24623,
            24632,
            24641,
            24650,
            24659,
            24668,
            24677,
            24684,
            24691,
            24698,
            24706,
            24714,
            24722,
            24730,
            24738,
            24746,
            24754,
            24762,
            24770,
            24778,
            24786,
            24794,
            24802,
            24810,
            24818,
            24826,
            24834,
            24842,
            24850,
            24858,
            24866,
            24874,
            24882,
            24890,
            24898,
            24906,
            24914,
            24920,
            24926,
            24932,
            24938,
            24944,
            24950,
            24956,
            24962,
            24968,
            24974,
            24980,
            24989,
            24998,
            25007,
            25016,
            25025,
            25034,
            25043,
            25052,
            25061,
            25070,
            25079,
            25088,
            25097,
            25106,
            25115,
            25124,
            25133,
            25142,
            25149,
            25156,
            25163,
            25170,
            25177,
            25184,
            25191,
            25198,
            25205,
            25212,
            25219,
            25226,
            25233,
            25240,
            25247,
            25254,
            25261,
            25268,
            25275,
            25282,
            25289,
            25294,
            25301,
            25308,
            25315,
            25322,
            25329,
            25335,
            25341,
            25347,
            25353,
            25359,
            25365,
            25371,
            25377,
            25383,
            25389,
            25395,
            25403,
            25411,
            25419,
            25427,
            25435,
            25443,
            25451,
            25459,
            25467,
            25475,
            25483,
            25491,
            25499,
            25507,
            25515,
            25523,
            25531,
            25539,
            25547,
            25555,
            25563,
            25571,
            25579,
            25587,
            25595,
            25603,
            25611,
            25619,
            25627,
            25635,
            25643,
            25651,
            25659,
            25667,
            25675,
            25683,
            25691,
            25699,
            25707,
            25715,
            25723,
            25731,
            25739,
            25747,
            25755,
            25763,
            25771,
            25779,
            25787,
            25795,
            25803,
            25811,
            25819,
            25827,
            25837,
            25847,
            25857,
            25867,
            25877,
            25887,
            25897,
            25907,
            25917,
            25927,
            25937,
            25947,
            25957,
            25967,
            25977,
            25987,
            25997,
            26007,
            26014,
            26021,
            26028,
            26035,
            26042,
            26049,
            26056,
            26067,
            26078,
            26089,
            26100,
            26111,
            26116,
            26121,
            26130,
            26139,
            26148,
            26157,
            26166,
            26175,
            26184,
            26193,
            26202,
            26211,
            26220,
            26229,
            26238,
            26247,
            26256,
            26265,
            26274,
            26283,
            26291,
            26299,
            26307,
            26315,
            26323,
            26331,
            26339,
            26347,
            26355,
            26363,
            26371,
            26379,
            26387,
            26395,
            26403,
            26411,
            26419,
            26427,
            26435,
            26443,
            26451,
            26459,
            26467,
            26475,
            26483,
            26491,
            26499,
            26506,
            26513,
            26520,
            26527,
            26534,
            26541,
            26548,
            26555,
            26562,
            26569,
            26576,
            26583,
            26590,
            26597,
            26604,
            26611,
            26618,
            26625,
            26632,
            26639,
            26646,
            26653,
            26660,
            26667,
            26674,
            26680,
            26686,
            26692,
            26698,
            26704,
            26710,
            26716,
            26722,
            26728,
            26734,
            26740,
            26745,
            26755,
            26765,
            26775,
            26785,
            26795,
            26805,
            26815,
            26825,
            26835,
            26845,
            26855,
            26865,
            26875,
            26885,
            26895,
            26905,
            26915,
            26925,
            26931,
            26937,
            26944,
            26951,
            26958,
            26965,
            26971,
            26977,
            26983,
            26989,
            26995,
            27001,
            27007,
            27013,
            27019,
            27025,
            27031,
            27037,
            27043,
            27054,
            27065,
            27076,
            27087,
            27098,
            27105,
            27112,
            27119,
            27126,
            27133,
            27140,
            27147,
            27154,
            27161,
            27168,
            27175,
            27182,
            27189,
            27196,
            27203,
            27210,
            27217,
            27224,
            27231,
            27238,
            27246,
            27254,
            27262,
            27270,
            27278,
            27286,
            27294,
            27302,
            27310,
            27318,
            27326,
            27334,
            27342,
            27350,
            27358,
            27366,
            27374,
            27382,
            27390,
            27398,
            27406,
            27414,
            27422,
            27430,
            27438,
            27446,
            27454,
            27463,
            27472,
            27481,
            27490,
            27499,
            27508,
            27517,
            27526,
            27535,
            27544,
            27553,
            27562,
            27571,
            27580,
            27589,
            27598,
            27607,
            27616,
            27623,
            27630,
            27637,
            27644,
            27651,
            27658,
            27665,
            27672,
            27679,
            27686,
            27693,
            27700,
            27707,
            27714,
            27721,
            27728,
            27735,
            27742,
            27749,
            27756,
            27763,
            27769,
            27775,
            27781,
            27787,
            27794,
            27801,
            27808,
            27815,
            27824,
            27833,
            27842,
            27851,
            27860,
            27869,
            27878,
            27887,
            27896,
            27905,
            27914,
            27924,
            27934,
            27944,
            27954,
            27964,
            27974,
            27984,
            27994,
            28004,
            28014,
            28024,
            28031,
            28038,
            28045,
            28052,
            28058,
            28064,
            28071,
            28078,
            28085,
            28092,
            28102,
            28112,
            28122,
            28132,
            28142,
            28152,
            28162,
            28172,
            28182,
            28192,
            28202,
            28212,
            28222,
            28232,
            28242,
            28252,
            28262,
            28272,
            28279,
            28286,
            28293,
            28300,
            28310,
            28320,
            28330,
            28340,
            28350,
            28360,
            28370,
            28380,
            28390,
            28400,
            28410,
            28420,
            28430,
            28440,
            28450,
            28460,
            28470,
            28480,
            28485,
            28490,
            28498,
            28506,
            28514,
            28522,
            28530,
            28538,
            28546,
            28554,
            28562,
            28570,
            28578,
            28586,
            28594,
            28602,
            28610,
            28618,
            28626,
            28634,
            28642,
            28650,
            28658,
            28666,
            28674,
            28682,
            28690,
            28698,
            28706,
            28714,
            28722,
            28730,
            28738,
            28746,
            28754,
            28762,
            28770,
            28778,
            28786,
            28794,
            28802,
            28809,
            28816,
            28823,
            28834,
            28845,
            28856,
            28867,
            28878,
            28884,
            28890,
            28899,
            28908,
            28917,
            28926,
            28935,
            28944,
            28953,
            28962,
            28971,
            28980,
            28989,
            28998,
            29007,
            29016,
            29025,
            29034,
            29043,
            29052,
            29058,
            29064,
            29071,
            29078,
            29085,
            29092,
            29098,
            29104,
            29109,
            29118,
            29127,
            29136,
            29145,
            29154,
            29163,
            29172,
            29181,
            29190,
            29199,
            29208,
            29217,
            29226,
            29235,
            29244,
            29253,
            29262,
            29271,
            29277,
            29283,
            29290,
            29297,
            29304,
            29310,
            29316,
            29323,
            29330,
            29337,
            29344,
            29351,
            29358,
            29365,
            29372,
            29379,
            29386,
            29393,
            29400,
            29407,
            29414,
            29421,
            29428,
            29435,
            29442,
            29449,
            29456,
            29463,
            29470,
            29477,
            29484,
            29491,
            29497,
            29503,
            29510,
            29517,
            29524,
            29531,
            29538,
            29545,
            29552,
            29559,
            29566,
            29573,
            29580,
            29587,
            29594,
            29601,
            29608,
            29615,
            29622,
            29629,
            29636,
            29643,
            29650,
            29657,
            29663,
            29669,
            29675,
            29681,
            29687,
            29693,
            29699,
            29705,
            29711,
            29717,
            29723,
            29729,
            29735,
            29741,
            29747,
            29754,
            29761,
            29768,
            29775,
            29782,
            29789,
            29796,
            29803,
            29810,
            29817,
            29824,
            29831,
            29838,
            29845,
            29852,
            29859,
            29866,
            29873,
            29880,
            29887,
            29894,
            29901,
            29908,
            29915,
            29922,
            29929,
            29936,
            29943,
            29950,
            29957,
            29964,
            29971,
            29978,
            29985,
            29992,
            29999,
            30006,
            30013,
            30020,
            30027,
            30034,
            30040,
            30046,
            30055,
            30064,
            30073,
            30082,
            30091,
            30100,
            30109,
            30118,
            30127,
            30136,
            30145,
            30154,
            30163,
            30172,
            30181,
            30190,
            30199,
            30208,
            30213,
            30222,
            30231,
            30240,
            30249,
            30258,
            30267,
            30276,
            30285,
            30294,
            30303,
            30312,
            30321,
            30330,
            30339,
            30348,
            30357,
            30366,
            30375,
            30382,
            30389,
            30396,
            30404,
            30412,
            30420,
            30428,
            30436,
            30444,
            30452,
            30460,
            30468,
            30476,
            30484,
            30492,
            30500,
            30508,
            30516,
            30524,
            30532,
            30540,
            30548,
            30556,
            30564,
            30572,
            30580,
            30588,
            30596,
            30604,
            30612,
            30618,
            30624,
            30630,
            30636,
            30642,
            30648,
            30654,
            30660,
            30666,
            30672,
            30678,
            30687,
            30696,
            30705,
            30714,
            30723,
            30732,
            30741,
            30750,
            30759,
            30768,
            30777,
            30786,
            30795,
            30804,
            30813,
            30822,
            30831,
            30840,
            30847,
            30854,
            30861,
            30868,
            30875,
            30882,
            30889,
            30896,
            30903,
            30910,
            30917,
            30924,
            30931,
            30938,
            30945,
            30952,
            30959,
            30966,
            30973,
            30980,
            30987,
            30992,
            30999,
            31006,
            31013,
            31020,
            31027,
            31033,
            31039,
            31045,
            31051,
            31057,
            31063,
            31069,
            31075,
            31081,
            31087,
            31093,
            31101,
            31109,
            31117,
            31125,
            31133,
            31141,
            31149,
            31157,
            31165,
            31173,
            31181,
            31189,
            31197,
            31205,
            31213,
            31221,
            31229,
            31237,
            31245,
            31253,
            31261,
            31269,
            31277,
            31285,
            31293,
            31301,
            31309,
            31317,
            31325,
            31333,
            31341,
            31349,
            31357,
            31365,
            31373,
            31381,
            31389,
            31397,
            31405,
            31413,
            31421,
            31429,
            31437,
            31445,
            31453,
            31461,
            31469,
            31477,
            31485,
            31493,
            31501,
            31509,
            31517,
            31525,
            31535,
            31545,
            31555,
            31565,
            31575,
            31585,
            31595,
            31605,
            31615,
            31625,
            31635,
            31645,
            31655,
            31665,
            31675,
            31685,
            31695,
            31705,
            31712,
            31719,
            31726,
            31733,
            31740,
            31747,
            31754,
            31765,
            31776,
            31787,
            31798,
            31809,
            31814,
            31819,
            31828,
            31837,
            31846,
            31855,
            31864,
            31873,
            31882,
            31891,
            31900,
            31909,
            31918,
            31927,
            31936,
            31945,
            31954,
            31963,
            31972,
            31981,
            31989,
            31997,
            32005,
            32013,
            32021,
            32029,
            32037,
            32045,
            32053,
            32061,
            32069,
            32077,
            32085,
            32093,
            32101,
            32109,
            32117,
            32125,
            32133,
            32141,
            32149,
            32157,
            32165,
            32173,
            32181,
            32189,
            32197,
            32204,
            32211,
            32218,
            32225,
            32232,
            32239,
            32246,
            32253,
            32260,
            32267,
            32274,
            32281,
            32288,
            32295,
            32302,
            32309,
            32316,
            32323,
            32330,
            32337,
            32344,
            32351,
            32358,
            32365,
            32372,
            32378,
            32384,
            32390,
            32396,
            32402,
            32408,
            32414,
            32420,
            32426,
            32432,
            32438,
            32443,
            32453,
            32463,
            32473,
            32483,
            32493,
            32503,
            32513,
            32523,
            32533,
            32543,
            32553,
            32563,
            32573,
            32583,
            32593,
            32603,
            32613,
            32623,
            32629,
            32635,
            32642,
            32649,
            32656,
            32663,
            32669,
            32675,
            32681,
            32687,
            32693,
            32699,
            32705,
            32711,
            32717,
            32723,
            32729,
            32735,
            32741,
            32752,
            32763,
            32774,
            32785,
            32796,
            32803,
            32810,
            32817,
            32824,
            32831,
            32838,
            32845,
            32852,
            32859,
            32866,
            32873,
            32880,
            32887,
            32894,
            32901,
            32908,
            32915,
            32922,
            32929,
            32936,
            32944,
            32952,
            32960,
            32968,
            32976,
            32984,
            32992,
            33000,
            33008,
            33016,
            33024,
            33032,
            33040,
            33048,
            33056,
            33064,
            33072,
            33080,
            33088,
            33096,
            33104,
            33112,
            33120,
            33128,
            33136,
            33144,
            33152,
            33161,
            33170,
            33179,
            33188,
            33197,
            33206,
            33215,
            33224,
            33233,
            33242,
            33251,
            33260,
            33269,
            33278,
            33287,
            33296,
            33305,
            33314,
            33321,
            33328,
            33335,
            33342,
            33349,
            33356,
            33363,
            33370,
            33377,
            33384,
            33391,
            33398,
            33405,
            33412,
            33419,
            33426,
            33433,
            33440,
            33447,
            33454,
            33461,
            33467,
            33473,
            33479,
            33485,
            33492,
            33499,
            33506,
            33513,
            33522,
            33531,
            33540,
            33549,
            33558,
            33567,
            33576,
            33585,
            33594,
            33603,
            33612,
            33622,
            33632,
            33642,
            33652,
            33662,
            33672,
            33682,
            33692,
            33702,
            33712,
            33722,
            33729,
            33736,
            33743,
            33750,
            33756,
            33762,
            33769,
            33776,
            33783,
            33790,
            33800,
            33810,
            33820,
            33830,
            33840,
            33850,
            33860,
            33870,
            33880,
            33890,
            33900,
            33910,
            33920,
            33930,
            33940,
            33950,
            33960,
            33970,
            33977,
            33984,
            33991,
            33998,
            34008,
            34018,
            34028,
            34038,
            34048,
            34058,
            34068,
            34078,
            34088,
            34098,
            34108,
            34118,
            34128,
            34138,
            34148,
            34158,
            34168,
            34178,
            34183,
        ],
        dtype=torch.int32,
    )


@requires_cuda
def test_segscan_highly_segmented3(extension):
    x = torch.arange(34188 * 16, dtype=torch.float32).reshape(-1, 16)
    segs = highly_segmented3()

    xcuda = x.to(device="cuda")
    segscuda = segs.to(device="cuda")
    y = extension.ht_segscan_incl(x, segs)
    ycuda = extension.ht_segscan_incl(xcuda, segscuda)
    # print("y cpu")
    # print(y)
    # print("y cuda")
    # print(ycuda.cpu())
    torch.testing.assert_allclose(ycuda.to(device="cpu"), y)


@requires_cuda
@pytest.mark.benchmark
def test_segscan_excl_cuda_bench(benchmark, extension):
    """CUDA segscan benchmark"""
    x = torch.ones(10000000, dtype=torch.float32)
    segs = torch.tensor([4, 7, 35, 273, 1129, 43567, 143678, 567778], dtype=torch.int)
    xcuda = x.to(device="cuda")
    segscuda = segs.to(device="cuda")

    def cuda_segscan():
        return extension.segscan_excl(xcuda, segscuda)

    benchmark(cuda_segscan)


@requires_cuda
@pytest.mark.benchmark
def test_segscan_incl_cuda_bench(benchmark, extension):
    """CUDA segscan benchmark"""
    x = torch.ones(10000000, dtype=torch.float32)
    segs = torch.tensor([4, 7, 35, 273, 1129, 43567, 143678, 567778], dtype=torch.int)
    xcuda = x.to(device="cuda")
    segscuda = segs.to(device="cuda")

    def cuda_segscan():
        return extension.segscan_incl(xcuda, segscuda)

    benchmark(cuda_segscan)


@requires_cuda
@pytest.mark.benchmark
def test_segscan_cpu_bench(benchmark, extension):
    """CPU segscan baseline benchmark"""
    x = torch.ones(10000000, dtype=torch.float32)
    segs = torch.tensor([4, 7, 35, 273, 1129, 43567, 143678, 567778], dtype=torch.int)

    def cpu_segscan():
        return extension.segscan_incl(x, segs)

    benchmark(cpu_segscan)
